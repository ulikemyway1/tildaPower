<template>
  <svg xmlns="http://www.w3.org/2000/svg" hidden style="display: none">
    <symbol id="delete-icon" viewBox="0 0 28 28" fill="currentColor">
      <path
        d="M25.72 15.27l1.33-1a2.47 2.47 0 00-.75-4.29l-1.6-.51a1.72 1.72 0 01-1.15-2l.37-1.66A2.43 2.43 0 0020.62 3l-1.55.65a1.68 1.68 0 01-2.15-.79l-.77-1.51a2.41 2.41 0 00-4.3 0l-.77 1.51a1.68 1.68 0 01-2.15.79L7.38 3a2.43 2.43 0 00-3.3 2.8l.37 1.66a1.72 1.72 0 01-1.15 2l-1.6.51a2.47 2.47 0 00-.7 4.27l1.33 1a1.73 1.73 0 01.4 2.29L1.78 19a2.45 2.45 0 002.15 3.77l1.67-.08a1.7 1.7 0 011.76 1.49l.22 1.68a2.42 2.42 0 004 1.49l1.23-1.15a1.68 1.68 0 012.29 0l1.23 1.15a2.42 2.42 0 004-1.49l.22-1.68a1.7 1.7 0 011.76-1.49l1.67.08A2.45 2.45 0 0026.22 19l-.9-1.43a1.73 1.73 0 01.4-2.3zM14 20.77A6.77 6.77 0 1120.77 14 6.77 6.77 0 0114 20.77z"
      ></path>
    </symbol>

    <symbol id="cart-icon" viewBox="0 0 64 64" fill="currentColor">
      <g>
        <g id="Icon-Trash" transform="translate(232.000000, 228.000000)">
          <polygon
            class="st0"
            id="Fill-6"
            points="-207.5,-205.1 -204.5,-205.1 -204.5,-181.1 -207.5,-181.1    "
          />
          <polygon
            class="st0"
            id="Fill-7"
            points="-201.5,-205.1 -198.5,-205.1 -198.5,-181.1 -201.5,-181.1    "
          />
          <polygon
            class="st0"
            id="Fill-8"
            points="-195.5,-205.1 -192.5,-205.1 -192.5,-181.1 -195.5,-181.1    "
          />
          <polygon
            class="st0"
            id="Fill-9"
            points="-219.5,-214.1 -180.5,-214.1 -180.5,-211.1 -219.5,-211.1    "
          />
          <path
            class="st0"
            d="M-192.6-212.6h-2.8v-3c0-0.9-0.7-1.6-1.6-1.6h-6c-0.9,0-1.6,0.7-1.6,1.6v3h-2.8v-3     c0-2.4,2-4.4,4.4-4.4h6c2.4,0,4.4,2,4.4,4.4V-212.6"
            id="Fill-10"
          />
          <path
            class="st0"
            d="M-191-172.1h-18c-2.4,0-4.5-2-4.7-4.4l-2.8-36l3-0.2l2.8,36c0.1,0.9,0.9,1.6,1.7,1.6h18     c0.9,0,1.7-0.8,1.7-1.6l2.8-36l3,0.2l-2.8,36C-186.5-174-188.6-172.1-191-172.1"
            id="Fill-11"
          />
        </g>
      </g>
    </symbol>

    <symbol id="plus-icon" viewBox="0 0 27 27" fill="none">
      <defs />
      <g
        id="Page-1"
        stroke="none"
        stroke-width="1"
        fill="none"
        fill-rule="evenodd"
        sketch:type="MSPage"
      >
        <g id="tp-08-add" sketch:type="MSLayerGroup">
          <path
            d="M13.5,26.5 C6.32026694,26.5 0.5,20.6797331 0.5,13.5 C0.5,6.32026694 6.32026694,0.5 13.5,0.5 C20.6797331,0.5 26.5,6.32026694 26.5,13.5 C26.5,20.6797331 20.6797331,26.5 13.5,26.5 Z"
            id="Shape"
            fill="currentColor"
            sketch:type="MSShapeGroup"
          />
          <path
            d="M12.879,8.826 L12.879,12.897 L8.964,12.897 L8.964,13.936 L12.879,13.936 L12.879,18.042 L13.988,18.042 L13.988,13.936 L17.903,13.936 L17.903,12.897 L13.988,12.897 L13.988,8.826 L12.879,8.826 L12.879,8.826 Z"
            id="Path"
            fill="white"
            sketch:type="MSShapeGroup"
          />
        </g>
      </g>
    </symbol>

    <symbol
      id="copy-icon"
      x="0px"
      y="0px"
      viewBox="-632 702.1 14.2 14.2"
      enable-background="new -632 702.1 14.2 14.2"
      xml:space="preserve"
      fill="currentColor"
    >
      <g>
        <path d="M-622.2,710.8h1.8v-6.5h-5.8v1.9l-1.5,0v-3.4h8.8v9.5h-3.2L-622.2,710.8z" />
        <path
          d="M-625.7,706.1h3.6v4v1.5v4h-8.8v-9.5h3.7C-627.2,706.1-625.7,706.1-625.7,706.1z M-629.4,714.1h5.8v-6.5h-5.8   C-629.4,707.6-629.4,714.1-629.4,714.1z"
        />
      </g>
    </symbol>

    <symbol id="up-icon" viewBox="0 0 12 12" fill="none">
      <path
        d="M4.375 5.78947V12H6.625V5.78947H10L5.5 0L1 5.78947H4.375Z"
        fill="currentColor"
      ></path>
    </symbol>

    <symbol id="down-icon" viewBox="0 0 12 12" fill="none">
      <path
        d="M6.625 6.21053L6.625 -2.95052e-07L4.375 -4.91753e-07L4.375 6.21053L1 6.21053L5.5 12L10 6.21053L6.625 6.21053Z"
        fill="currentColor"
      ></path>
    </symbol>

    <symbol id="menu-icon-cross" viewBox="0 0 20 20" fill="currentColor">
      <path
        d="M11.105 10.001l8.666-8.666c.305-.305.305-.8 0-1.105-.305-.305-.8-.305-1.105 0l-8.666 8.666-8.666-8.666c-.305-.305-.8-.305-1.105 0-.305.305-.305.8 0 1.105l8.666 8.666-8.666 8.666c-.305.305-.305.8 0 1.105.153.152.352.229.552.229.2 0 .4-.076.552-.229l8.666-8.666 8.666 8.666c.152.152.352.229.552.229.2 0 .4-.076.553-.229.305-.305.305-.8 0-1.105l-8.666-8.666z"
      />
    </symbol>
  </svg>
  <div class="edit-block-wrapper">
    <button
      type="button"
      class="button-link button-link--colored edit-block-wrapper__content"
      @click="openContentModal"
    >
      Контент
    </button>
    <button
      type="button"
      class="button-link button-link--icon edit-block-wrapper__add"
      @click="toggleModalStatus('toolbar')"
    >
      <svg role="img" aria-hidden="true" width="50" height="50" aria-label="Add Element">
        <use xlink:href="#plus-icon"></use>
      </svg>
    </button>
    <div class="edit-block-wrapper__buttons">
      <button
        type="button"
        class="button-link button-link--icon edit-block-wrapper__btn"
        @click="upBlock"
      >
        <svg role="img" aria-hidden="true" width="30" height="30" aria-label="Up Element">
          <use xlink:href="#up-icon"></use>
        </svg>
      </button>
      <button
        type="button"
        class="button-link button-link--icon edit-block-wrapper__btn"
        @click="copyBlock"
      >
        <svg role="img" aria-hidden="true" width="30" height="30" aria-label="Copy Element">
          <use xlink:href="#copy-icon"></use>
        </svg>
      </button>
      <button type="button" class="button-link button-link--icon edit-block-wrapper__btn">
        <svg
          role="img"
          aria-hidden="true"
          width="30"
          height="30"
          aria-label="Remove Element"
          @click="removeBlock"
        >
          <use xlink:href="#cart-icon"></use>
        </svg>
      </button>
      <button
        type="button"
        class="button-link button-link--icon edit-block-wrapper__btn"
        @click="downBlock"
      >
        <svg role="img" aria-hidden="true" width="30" height="30" aria-label="Down Element">
          <use xlink:href="#down-icon"></use>
        </svg>
      </button>
    </div>
  </div>
</template>

<script>
import { mapActions } from 'pinia'
import { useModalsStore } from '@/stores/modalsStore'
import { useSitesStore } from '@/stores/sitesStore'

export default {
  props: {
    index: {
      type: Number,
      required: true
    }
  },

  data() {
    return {
      pageID: '',
      siteID: ''
    }
  },

  methods: {
    ...mapActions(useModalsStore, ['toggleModalStatus', 'setContentToolbarID']),
    ...mapActions(useSitesStore, ['getEditingPageID', 'getEditingSiteID', 'manipulateWithBlocks']),

    openContentModal() {
      this.setContentToolbarID(this.index)
      this.toggleModalStatus('contentToolbar')
    },

    removeBlock() {
      this.manipulateWithBlocks(this.siteID, this.pageID, this.index, {
        type: 'remove'
      })
    },
    upBlock() {
      this.manipulateWithBlocks(this.siteID, this.pageID, this.index, {
        type: 'up'
      })
    },
    downBlock() {
      this.manipulateWithBlocks(this.siteID, this.pageID, this.index, {
        type: 'down'
      })
    },
    copyBlock() {
      this.manipulateWithBlocks(this.siteID, this.pageID, this.index, {
        type: 'copy'
      })
    }
  },
  mounted() {
    this.pageID = this.getEditingPageID()
    this.siteID = this.getEditingSiteID()
  }
}
</script>
